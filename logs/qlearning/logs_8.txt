class PTActorModel(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], 256) if len(state_size)==1 else Conv(state_size, 256)
		self.layer2 = torch.nn.Linear(256, 256)
		# self.layer3 = torch.nn.Linear(256, 256)
		self.action_mu = torch.nn.Linear(256, *action_size)
		self.action_sig = torch.nn.Linear(256, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).tanh() # state: (batch, 256)
		state = self.layer2(state).tanh() + state # state: (batch, 256)
		# state = self.layer3(state).tanh() # state: (batch, 256)
		action_mu = self.action_mu(state).tanh()
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig) # action: (batch, action_size)
		action = action_mu + epsilon.mul(action_sig) # action: (batch, action_size)
		return action.tanh()
	
class PTCriticModel(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], 256) if len(state_size)==1 else Conv(state_size, 256)
		self.net_action = torch.nn.Linear(*action_size, 256)
		self.net_layer1 = torch.nn.Linear(512, 256)
		# self.net_layer2 = torch.nn.Linear(256, 256)
		self.q_value = torch.nn.Linear(256, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).tanh() # state: (batch, 256)
		net_action = self.net_action(action).tanh()
		net_layer = torch.cat([state, net_action], dim=1)
		net_layer = self.net_layer1(net_layer).tanh()
		# net_layer = self.net_layer2(net_layer).tanh() + net_layer
		q_value = self.q_value(net_layer)
		return q_value

Ep: 0, Reward: -65.75342465753471, Avg: -65.75342465753471
Ep: 1, Reward: -73.50993377483451, Avg: -69.63167921618461
Ep: 2, Reward: -56.989247311828734, Avg: -65.41753524806599
Ep: 3, Reward: -38.22393822393879, Avg: -58.61913599203419
Ep: 4, Reward: -30.091185410334575, Avg: -52.91354587569426
Ep: 5, Reward: -18.819188191881775, Avg: -47.231152928392184
Ep: 6, Reward: -56.521739130435236, Avg: -48.55837952868405
Ep: 7, Reward: -46.56488549618365, Avg: -48.3091927746215
Ep: 8, Reward: -69.51219512195165, Avg: -50.66508192432485
Ep: 9, Reward: -59.044368600683086, Avg: -51.503010591960674
Ep: 10, Reward: -20.245398773006062, Avg: -48.66140951751026
Ep: 11, Reward: -6.367041198501939, Avg: -45.13687882425956
Ep: 12, Reward: -28.571428571429045, Avg: -43.86261342019567
Ep: 13, Reward: -75.46012269938647, Avg: -46.119578368709305
Ep: 14, Reward: -55.93220338983119, Avg: -46.77375337011743
Ep: 15, Reward: -47.73519163763094, Avg: -46.83384326183702
Ep: 16, Reward: -73.94136807817554, Avg: -48.42840354515105
Ep: 17, Reward: -62.38244514106649, Avg: -49.20362807825746
Ep: 18, Reward: -26.9102990033229, Avg: -48.030294969050374
Ep: 19, Reward: -62.40601503759466, Avg: -48.749080972477586
Ep: 20, Reward: -79.16666666666639, Avg: -50.19753743410562
Ep: 21, Reward: -72.13622291021687, Avg: -51.1947504102925
Ep: 22, Reward: -43.609022556391345, Avg: -50.86493615577506
Ep: 23, Reward: -77.69516728624518, Avg: -51.98286245287799
Ep: 24, Reward: -66.16541353383504, Avg: -52.550164496116274
Ep: 25, Reward: -157.23757961783485, Avg: -56.576603539259295
Ep: 26, Reward: -43.708609271523386, Avg: -56.100011158972784
Ep: 27, Reward: -62.82527881040943, Avg: -56.34019928938123
Ep: 28, Reward: -75.77854671280271, Avg: -57.010487131568176
Ep: 29, Reward: -64.14342629482138, Avg: -57.24825177034328
Ep: 30, Reward: -69.17808219178097, Avg: -57.6330850097445
Ep: 31, Reward: -72.60273972602751, Avg: -58.10088671962835
Ep: 32, Reward: -60.655737704918515, Avg: -58.17830644645532
Ep: 33, Reward: -79.02097902097874, Avg: -58.79132622805895
Ep: 34, Reward: -58.188153310105, Avg: -58.77409271611741
Ep: 35, Reward: -47.16981132075516, Avg: -58.451751566246244
Ep: 36, Reward: -72.22222222222231, Avg: -58.82392644884019
Ep: 37, Reward: -86.18784530386678, Avg: -59.54402957660404
Ep: 38, Reward: -72.76264591439708, Avg: -59.88296845706027
Ep: 39, Reward: -62.121212121212785, Avg: -59.93892454866409
Ep: 40, Reward: -67.9715302491108, Avg: -60.13484176087011
Ep: 41, Reward: -43.46289752650219, Avg: -59.73789070767087
Ep: 42, Reward: -72.0000000000001, Avg: -60.02305604005062
Ep: 43, Reward: -37.93103448275874, Avg: -59.52096464102126
Ep: 44, Reward: -82.99319727891108, Avg: -60.04256981075214
Ep: 45, Reward: -66.10169491525465, Avg: -60.174289921719584
Ep: 46, Reward: -48.38709677419384, Avg: -59.9234985781552
Ep: 47, Reward: -77.70700636942661, Avg: -60.293988323806694
Ep: 48, Reward: -64.70588235294174, Avg: -60.38402697746251
Ep: 49, Reward: -38.18181818181849, Avg: -59.93998280154963
Ep: 50, Reward: -77.19869706840373, Avg: -60.27838896364481
Ep: 51, Reward: -26.04501607717037, Avg: -59.62005486967415
Ep: 52, Reward: -43.894389438944195, Avg: -59.3233442011698
Ep: 53, Reward: -72.65625000000007, Avg: -59.570249864111105
Ep: 54, Reward: -32.432432432432584, Avg: -59.07683500171695
Ep: 55, Reward: -57.446808510638924, Avg: -59.04772738580484
Ep: 56, Reward: -17.60299625468185, Avg: -58.32062683964479
Ep: 57, Reward: -60.13289036544926, Avg: -58.35187276250349
Ep: 58, Reward: -81.94945848375409, Avg: -58.75183184252468
Ep: 59, Reward: -45.255474452555056, Avg: -58.526892552691855
Ep: 60, Reward: -78.72340425531891, Avg: -58.85798290847263
Ep: 61, Reward: -74.63768115942028, Avg: -59.1124941705847
Ep: 62, Reward: -58.76288659793859, Avg: -59.10694484403476
Ep: 63, Reward: -36.50793650793716, Avg: -58.753835338783226
Ep: 64, Reward: -84.02555910543077, Avg: -59.14263108903934
Ep: 65, Reward: -80.5825242718443, Avg: -59.467477955445474
Ep: 66, Reward: -70.14925373134352, Avg: -59.62690744463798
Ep: 67, Reward: -75.35211267605627, Avg: -59.85816046274707
Ep: 68, Reward: -68.19787985865685, Avg: -59.97902596123851
Ep: 69, Reward: -134.1230769230771, Avg: -61.038226689264775
Ep: 70, Reward: -44.95412844036725, Avg: -60.81169009420989
Ep: 71, Reward: -44.07894736842138, Avg: -60.57929088968505
Ep: 72, Reward: 6.382978723404285, Avg: -59.661999525122184
Ep: 73, Reward: -65.38461538461593, Avg: -59.7393321718721
Ep: 74, Reward: -26.829268292682986, Avg: -59.30053132014958
Ep: 75, Reward: -78.64768683274, Avg: -59.55509915584156
Ep: 76, Reward: -25.795053003533454, Avg: -59.11665699801937
Ep: 77, Reward: -46.70846394984355, Avg: -58.95757759996583
Ep: 78, Reward: -65.8385093167707, Avg: -59.044678001444375
Ep: 79, Reward: -44.95412844036751, Avg: -58.86854613193093
Ep: 80, Reward: -83.38870431893638, Avg: -59.171264134239635
Ep: 81, Reward: -47.552447552448164, Avg: -59.02957124909584
Ep: 82, Reward: -19.58041958041999, Avg: -58.55428026513589
Ep: 83, Reward: -71.06109324758862, Avg: -58.703170895879374
Ep: 84, Reward: -60.144927536232665, Avg: -58.72013273870706
Ep: 85, Reward: -13.621262458471524, Avg: -58.19572727033223
Ep: 86, Reward: -84.22712933753888, Avg: -58.4949387883461
Ep: 87, Reward: -30.091185410334404, Avg: -58.172168863595964
Ep: 88, Reward: -14.590747330960694, Avg: -57.682489969970845
Ep: 89, Reward: -81.27340823969999, Avg: -57.944611284078945
Ep: 90, Reward: -46.90265486725746, Avg: -57.823271103674315
Ep: 91, Reward: -63.45514950166172, Avg: -57.884487173217664
Ep: 92, Reward: -56.83453237410156, Avg: -57.87319733666802
Ep: 93, Reward: -139.60422535211285, Avg: -58.74267635810892
Ep: 94, Reward: -78.7234042553189, Avg: -58.95299980965851
Ep: 95, Reward: -42.85714285714302, Avg: -58.785334633069795
Ep: 96, Reward: -80.51948051948017, Avg: -59.009397992723514
Ep: 97, Reward: -80.19801980197987, Avg: -59.22560841934858
Ep: 98, Reward: -43.03797468354469, Avg: -59.06209696747178
Ep: 99, Reward: -72.22222222222233, Avg: -59.193698220019286
Ep: 100, Reward: -72.97297297297305, Avg: -59.26589370317368
Ep: 101, Reward: -39.285714285714704, Avg: -58.92365150828246
Ep: 102, Reward: -55.78231292517054, Avg: -58.91158216441588
Ep: 103, Reward: -28.85375494071211, Avg: -58.81788033158361
Ep: 104, Reward: -80.51948051948017, Avg: -59.32216328267507
Ep: 105, Reward: -61.038961038961645, Avg: -59.74436101114586
Ep: 106, Reward: -70.47970479704816, Avg: -59.883940667812006
Ep: 107, Reward: -77.34627831715198, Avg: -60.191754596021674
Ep: 108, Reward: -19.35483870967783, Avg: -59.69018103189894
Ep: 109, Reward: -55.390334572491184, Avg: -59.65364069161702
Ep: 110, Reward: -76.82119205298, Avg: -60.21939862441676
Ep: 111, Reward: -43.708609271524026, Avg: -60.592814305146995
Ep: 112, Reward: -45.945945945946406, Avg: -60.76655947889217
Ep: 113, Reward: -79.16666666666639, Avg: -60.803624918564964
Ep: 114, Reward: -78.79858657243791, Avg: -61.032288750391025
Ep: 115, Reward: -30.693069306931264, Avg: -60.86186752708402
Ep: 116, Reward: -55.10204081632721, Avg: -60.673474254465546
Ep: 117, Reward: -5.923344947735071, Avg: -60.10888325253223
Ep: 118, Reward: -27.00729927007321, Avg: -60.10985325519974
Ep: 119, Reward: 37.40458015267107, Avg: -59.11174730329708
Ep: 120, Reward: -83.60655737704866, Avg: -59.15614621040089
Ep: 121, Reward: -38.7096774193554, Avg: -58.82188075549227
Ep: 122, Reward: -73.68421052631574, Avg: -59.12263263519152
Ep: 123, Reward: -77.9874213836476, Avg: -59.125555176165534
Ep: 124, Reward: -48.14814814814884, Avg: -58.945382522308684
Ep: 125, Reward: -43.502824858757315, Avg: -57.808034974717906
Ep: 126, Reward: -64.78873239436669, Avg: -58.01883620594634
Ep: 127, Reward: -79.99999999999967, Avg: -58.190583417842255
Ep: 128, Reward: -80.39215686274476, Avg: -58.236719519341676
Ep: 129, Reward: -44.444444444444684, Avg: -58.039729700837896
Ep: 130, Reward: -44.64944649446566, Avg: -57.79444334386475
Ep: 131, Reward: -63.815789473684795, Avg: -57.706573841341324
Ep: 132, Reward: -11.111111111111372, Avg: -57.211127575403246
Ep: 133, Reward: -22.535211267605757, Avg: -56.646269897869516
Ep: 134, Reward: -43.46289752650236, Avg: -56.49901734003349
Ep: 135, Reward: -46.768060836502166, Avg: -56.49499983519095
Ep: 136, Reward: -39.93993993994034, Avg: -56.17217701236813
Ep: 137, Reward: -46.902654867257, Avg: -55.77932510800204
Ep: 138, Reward: -44.44444444444501, Avg: -55.49614309330253
Ep: 139, Reward: -33.33333333333359, Avg: -55.20826430542374
Ep: 140, Reward: -74.35897435897434, Avg: -55.27213874652238
Ep: 141, Reward: -45.945945945946676, Avg: -55.296969230716826
Ep: 142, Reward: -56.22895622895669, Avg: -55.13925879300639
Ep: 143, Reward: -2.439024390243654, Avg: -54.784338692081235
Ep: 144, Reward: -42.37288135593245, Avg: -54.37813553285146
Ep: 145, Reward: -62.96296296296348, Avg: -54.346748213328546
Ep: 146, Reward: -25.170068027210856, Avg: -54.114577925858704
Ep: 147, Reward: -42.17687074829994, Avg: -53.75927656964743
Ep: 148, Reward: -75.103734439834, Avg: -53.86325509051636
Ep: 149, Reward: -66.8874172185431, Avg: -54.1503110808836
Ep: 150, Reward: -20.454545454545414, Avg: -53.58286956474502
Ep: 151, Reward: -46.7680608365024, Avg: -53.790100012338335
Ep: 152, Reward: -31.40794223826755, Avg: -53.66523554033158
Ep: 153, Reward: -82.26950354609885, Avg: -53.76136807579256
Ep: 154, Reward: -79.16666666666639, Avg: -54.22871041813491
Ep: 155, Reward: -82.1428571428567, Avg: -54.47567090445708
Ep: 156, Reward: -56.250000000000696, Avg: -54.862140941910276
Ep: 157, Reward: -58.49056603773633, Avg: -54.84571769863314
Ep: 158, Reward: -27.63157894736846, Avg: -54.30253890326929
Ep: 159, Reward: -53.48837209302367, Avg: -54.38486787967397
Ep: 160, Reward: -26.910299003322496, Avg: -53.86673682715401
Ep: 161, Reward: -63.768115942029574, Avg: -53.7580411749801
Ep: 162, Reward: -67.53246753246788, Avg: -53.845736984325406
Ep: 163, Reward: -39.799331103679144, Avg: -53.87865093028281
Ep: 164, Reward: -49.324324324325, Avg: -53.53163858247176
Ep: 165, Reward: -45.686900958466936, Avg: -53.18268234933798
Ep: 166, Reward: -70.09966777408658, Avg: -53.18218648976541
Ep: 167, Reward: -46.2365591397853, Avg: -52.8910309544027
Ep: 168, Reward: -55.0898203592823, Avg: -52.75995035940896
Ep: 169, Reward: -29.487179487179564, Avg: -51.71359138504999
Ep: 170, Reward: -49.57983193277354, Avg: -51.75984841997404
Ep: 171, Reward: -66.1654135338351, Avg: -51.980713081628174
Ep: 172, Reward: -52.531645569620686, Avg: -52.56985932455843
Ep: 173, Reward: -42.67515923566929, Avg: -52.34276476306896
Ep: 174, Reward: -77.04918032786868, Avg: -52.84496388342082
Ep: 175, Reward: -13.4948096885811, Avg: -52.19343511197923
Ep: 176, Reward: -34.1692789968657, Avg: -52.277177371912536
Ep: 177, Reward: -36.90851735015813, Avg: -52.179177905915694
Ep: 178, Reward: -26.056338028169826, Avg: -51.78135619302969
Ep: 179, Reward: -81.06060606060568, Avg: -52.14242096923208
Ep: 180, Reward: -44.636678200692394, Avg: -51.75490070804963
Ep: 181, Reward: -68.19787985865761, Avg: -51.961355031111744
Ep: 182, Reward: -28.31541218637987, Avg: -52.04870495717133
Ep: 183, Reward: -29.53020134228208, Avg: -51.63339603811827
Ep: 184, Reward: -41.17647058823549, Avg: -51.44371146863829
Ep: 185, Reward: -27.835051546392446, Avg: -51.5858493595175
Ep: 186, Reward: -37.086092715232034, Avg: -51.11443899329443
Ep: 187, Reward: -25.696594427245223, Avg: -51.07049308346353
Ep: 188, Reward: -33.333333333334046, Avg: -51.25791894348727
Ep: 189, Reward: -65.75342465753425, Avg: -51.102719107665614
Ep: 190, Reward: -20.138888888889536, Avg: -50.83508144788193
Ep: 191, Reward: -72.04968944099389, Avg: -50.92102684727525
Ep: 192, Reward: -47.19471947194764, Avg: -50.82462871825371
Ep: 193, Reward: -21.42857142857161, Avg: -49.642872179018305
Ep: 194, Reward: -41.74757281553417, Avg: -49.273113864620456
Ep: 195, Reward: -62.71186440678022, Avg: -49.47166108011683
Ep: 196, Reward: -70.19867549668844, Avg: -49.36845302988891
Ep: 197, Reward: -19.014084507042597, Avg: -48.756613676939544
Ep: 198, Reward: -56.5217391304353, Avg: -48.89145132140844
Ep: 199, Reward: -74.27652733118975, Avg: -48.91199437249812
Ep: 200, Reward: -16.96750902527058, Avg: -48.35193973302109
Ep: 201, Reward: -65.15679442508761, Avg: -48.61065053441482
Ep: 202, Reward: -162.49516728624593, Avg: -49.67777907802558
Ep: 203, Reward: -40.19933554817291, Avg: -49.79123488410019
Ep: 204, Reward: -50.87719298245665, Avg: -49.49481200872995
Ep: 205, Reward: -35.81081081081085, Avg: -49.242530506448446
Ep: 206, Reward: -57.79220779220854, Avg: -49.115655536400055
Ep: 207, Reward: -48.387096774194255, Avg: -48.82606372097048
Ep: 208, Reward: -47.761194029851026, Avg: -49.1101272741722
Ep: 209, Reward: -65.73208722741477, Avg: -49.213544800721436
Ep: 210, Reward: -83.22147651006662, Avg: -49.27754764529231
Ep: 211, Reward: -60.57347670250952, Avg: -49.446196319602166
Ep: 212, Reward: -29.76588628762563, Avg: -49.28439572301896
Ep: 213, Reward: -55.05617977528135, Avg: -49.043290854105116
Ep: 214, Reward: -156.68059701492584, Avg: -49.82211095852999
Ep: 215, Reward: -39.49044585987276, Avg: -49.91008472405941
Ep: 216, Reward: -30.65693430656942, Avg: -49.66563365896182
Ep: 217, Reward: -24.460431654676583, Avg: -49.85100452603124
Ep: 218, Reward: -64.05228758169993, Avg: -50.2214544091475
Ep: 219, Reward: -62.500000000000625, Avg: -51.22050021067422
Ep: 220, Reward: -36.87707641196049, Avg: -50.75320540102334
Ep: 221, Reward: -66.6666666666671, Avg: -51.03277529349645
Ep: 222, Reward: -38.56655290102411, Avg: -50.68159871724353
