Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(list(zip(states, actions, targets, advantages)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -57.9315, Test: -51.2150 [15.92], Avg: -67.1323 (0.980)
Ep: 1, Reward: -54.6097, Test: -66.0303 [9.39], Avg: -71.2766 (0.960)
Ep: 2, Reward: -47.5883, Test: -59.8132 [16.37], Avg: -72.9120 (0.941)
Ep: 3, Reward: -60.7390, Test: -57.8494 [17.88], Avg: -73.6172 (0.922)
Ep: 4, Reward: -42.5574, Test: -60.2708 [17.51], Avg: -74.4496 (0.904)
Ep: 5, Reward: -56.8591, Test: -36.8737 [21.01], Avg: -71.6890 (0.886)
Ep: 6, Reward: -49.4958, Test: -61.1604 [12.44], Avg: -71.9626 (0.868)
Ep: 7, Reward: -59.3391, Test: -50.2344 [13.01], Avg: -70.8726 (0.851)
Ep: 8, Reward: -42.2670, Test: -43.5730 [23.93], Avg: -70.4982 (0.834)
Ep: 9, Reward: -61.7988, Test: -41.9009 [36.55], Avg: -71.2935 (0.817)
Ep: 10, Reward: -59.0838, Test: -49.1277 [26.09], Avg: -71.6500 (0.801)
Ep: 11, Reward: -47.4447, Test: -51.2000 [37.84], Avg: -73.0992 (0.785)
Ep: 12, Reward: -57.4550, Test: -56.0261 [22.54], Avg: -73.5201 (0.769)
Ep: 13, Reward: -66.0257, Test: -42.4781 [32.04], Avg: -73.5911 (0.754)
Ep: 14, Reward: -57.5016, Test: -52.4418 [23.04], Avg: -73.7170 (0.739)
Ep: 15, Reward: -49.5613, Test: -31.4653 [15.52], Avg: -72.0463 (0.724)
Ep: 16, Reward: -53.8146, Test: -43.0743 [17.95], Avg: -71.3980 (0.709)
Ep: 17, Reward: -26.1741, Test: -22.3510 [50.03], Avg: -71.4529 (0.695)
Ep: 18, Reward: -24.8589, Test: -54.9043 [17.61], Avg: -71.5088 (0.681)
Ep: 19, Reward: -36.1163, Test: -48.7602 [16.24], Avg: -71.1835 (0.668)
Ep: 20, Reward: -46.1451, Test: -48.0082 [34.84], Avg: -71.7389 (0.654)
Ep: 21, Reward: -31.0332, Test: -43.5072 [49.62], Avg: -72.7112 (0.641)
Ep: 22, Reward: -38.8245, Test: -39.2353 [19.56], Avg: -72.1063 (0.628)
Ep: 23, Reward: -30.7411, Test: -25.5257 [31.25], Avg: -71.4675 (0.616)
Ep: 24, Reward: -56.4676, Test: -25.3815 [26.01], Avg: -70.6645 (0.603)
Ep: 25, Reward: -25.2128, Test: -25.9064 [40.81], Avg: -70.5127 (0.591)
Ep: 26, Reward: -27.0693, Test: -20.6805 [51.23], Avg: -70.5645 (0.580)
Ep: 27, Reward: -11.6175, Test: -30.4215 [26.78], Avg: -70.0872 (0.568)
Ep: 28, Reward: -21.9027, Test: -14.2308 [35.44], Avg: -69.3833 (0.557)
Ep: 29, Reward: -27.6063, Test: -32.0663 [25.69], Avg: -68.9957 (0.545)
Ep: 30, Reward: -48.8553, Test: -37.5166 [56.10], Avg: -69.7900 (0.535)
Ep: 31, Reward: -23.7798, Test: -19.1790 [42.43], Avg: -69.5343 (0.524)
Ep: 32, Reward: 7.8995, Test: -1.0525 [50.11], Avg: -68.9776 (0.513)
Ep: 33, Reward: -8.3338, Test: 5.4491 [65.05], Avg: -68.7019 (0.503)
Ep: 34, Reward: 34.0456, Test: 32.0503 [82.91], Avg: -68.1922 (0.493)
Ep: 35, Reward: -5.8109, Test: -12.7971 [70.06], Avg: -68.5995 (0.483)
Ep: 36, Reward: 8.8610, Test: -5.2843 [64.55], Avg: -68.6328 (0.474)
Ep: 37, Reward: -17.7105, Test: 29.8337 [42.02], Avg: -67.1474 (0.464)
Ep: 38, Reward: -5.0753, Test: 20.6388 [71.67], Avg: -66.7342 (0.455)
Ep: 39, Reward: 25.5123, Test: -5.3423 [63.23], Avg: -66.7803 (0.446)
Ep: 40, Reward: 33.6574, Test: -1.3970 [75.84], Avg: -67.0353 (0.437)
Ep: 41, Reward: -9.5836, Test: 4.9154 [58.05], Avg: -66.7043 (0.428)
Ep: 42, Reward: 50.0763, Test: 56.9816 [106.09], Avg: -66.2950 (0.419)
Ep: 43, Reward: 47.8288, Test: 38.0333 [101.25], Avg: -66.2249 (0.411)
Ep: 44, Reward: 20.3391, Test: 97.1969 [46.12], Avg: -63.6181 (0.403)
Ep: 45, Reward: 78.9895, Test: 52.2725 [73.86], Avg: -62.7044 (0.395)
Ep: 46, Reward: 52.6118, Test: 75.0742 [86.44], Avg: -61.6121 (0.387)
Ep: 47, Reward: 126.6270, Test: 77.0719 [132.40], Avg: -61.4812 (0.379)
Ep: 48, Reward: 119.2572, Test: 175.0861 [144.28], Avg: -59.5978 (0.372)
Ep: 49, Reward: 127.0374, Test: 166.5495 [127.33], Avg: -57.6214 (0.364)
Ep: 50, Reward: 95.7279, Test: 150.9654 [132.88], Avg: -56.1369 (0.357)
Ep: 51, Reward: 122.2823, Test: 94.8907 [111.96], Avg: -55.3856 (0.350)
Ep: 52, Reward: 122.8688, Test: 166.5582 [98.57], Avg: -53.0579 (0.343)
Ep: 53, Reward: 151.3119, Test: 185.7624 [140.23], Avg: -51.2322 (0.336)
Ep: 54, Reward: 60.0676, Test: 196.1062 [113.51], Avg: -48.7990 (0.329)
Ep: 55, Reward: 157.7940, Test: 125.8624 [83.83], Avg: -47.1770 (0.323)
Ep: 56, Reward: 174.5576, Test: 179.8562 [148.83], Avg: -45.8050 (0.316)
Ep: 57, Reward: 171.7436, Test: 184.5789 [105.88], Avg: -43.6583 (0.310)
Ep: 58, Reward: 335.3611, Test: 245.7050 [167.03], Avg: -41.5848 (0.304)
Ep: 59, Reward: 262.1920, Test: 188.9294 [105.16], Avg: -39.4956 (0.298)
Ep: 60, Reward: 290.1113, Test: 316.3190 [138.82], Avg: -35.9383 (0.292)
Ep: 61, Reward: 233.3306, Test: 251.7050 [177.95], Avg: -34.1691 (0.286)
Ep: 62, Reward: 162.6703, Test: 73.7001 [101.61], Avg: -34.0698 (0.280)
Ep: 63, Reward: 199.8901, Test: 148.8603 [105.93], Avg: -32.8667 (0.274)
Ep: 64, Reward: 238.8625, Test: 238.2366 [144.22], Avg: -30.9146 (0.269)
Ep: 65, Reward: 215.5565, Test: 202.3954 [136.41], Avg: -29.4464 (0.264)
Ep: 66, Reward: 268.2707, Test: 171.9532 [110.36], Avg: -28.0876 (0.258)
Ep: 67, Reward: 219.0524, Test: 368.6584 [190.75], Avg: -25.0583 (0.253)
Ep: 68, Reward: 286.0110, Test: 419.6445 [179.56], Avg: -21.2157 (0.248)
Ep: 69, Reward: 401.9955, Test: 361.2058 [97.00], Avg: -17.1383 (0.243)
Ep: 70, Reward: 297.5393, Test: 486.2055 [177.24], Avg: -12.5453 (0.238)
Ep: 71, Reward: 300.6387, Test: 331.5202 [194.04], Avg: -10.4616 (0.233)
Ep: 72, Reward: 317.6959, Test: 317.8613 [127.08], Avg: -7.7049 (0.229)
Ep: 73, Reward: 333.5302, Test: 361.0392 [125.18], Avg: -4.4135 (0.224)
Ep: 74, Reward: 364.3822, Test: 406.9103 [155.95], Avg: -1.0085 (0.220)
Ep: 75, Reward: 419.8832, Test: 438.0008 [183.08], Avg: 2.3591 (0.215)
Ep: 76, Reward: 556.0629, Test: 424.3612 [192.79], Avg: 5.3358 (0.211)
Ep: 77, Reward: 548.5824, Test: 434.9492 [193.20], Avg: 8.3667 (0.207)
Ep: 78, Reward: 474.2452, Test: 468.6378 [131.58], Avg: 12.5273 (0.203)
Ep: 79, Reward: 534.7834, Test: 530.2363 [150.63], Avg: 17.1158 (0.199)
Ep: 80, Reward: 490.8011, Test: 529.6613 [131.38], Avg: 21.8215 (0.195)
Ep: 81, Reward: 520.3696, Test: 471.1883 [138.94], Avg: 25.6072 (0.191)
Ep: 82, Reward: 469.5317, Test: 475.7247 [174.86], Avg: 28.9236 (0.187)
Ep: 83, Reward: 526.1471, Test: 471.9907 [118.65], Avg: 32.7857 (0.183)
Ep: 84, Reward: 558.4459, Test: 540.0373 [193.28], Avg: 36.4795 (0.180)
Ep: 85, Reward: 579.5017, Test: 647.4579 [160.48], Avg: 41.7178 (0.176)
Ep: 86, Reward: 474.7673, Test: 530.0671 [179.60], Avg: 45.2667 (0.172)
Ep: 87, Reward: 660.6249, Test: 667.8311 [179.08], Avg: 50.3063 (0.169)
Ep: 88, Reward: 539.2907, Test: 474.6591 [230.93], Avg: 52.4796 (0.166)
Ep: 89, Reward: 340.8553, Test: 323.2359 [221.62], Avg: 53.0256 (0.162)
Ep: 90, Reward: 491.6527, Test: 501.8584 [260.70], Avg: 55.0930 (0.159)
Ep: 91, Reward: 629.1791, Test: 553.2867 [166.13], Avg: 58.7023 (0.156)
Ep: 92, Reward: 557.1427, Test: 673.8535 [124.61], Avg: 63.9770 (0.153)
Ep: 93, Reward: 545.5790, Test: 566.8582 [202.32], Avg: 67.1744 (0.150)
Ep: 94, Reward: 601.1410, Test: 628.4289 [153.70], Avg: 71.4645 (0.147)
Ep: 95, Reward: 573.9201, Test: 630.2179 [207.75], Avg: 75.1207 (0.144)
Ep: 96, Reward: 625.4765, Test: 713.8109 [122.51], Avg: 80.4422 (0.141)
Ep: 97, Reward: 609.8144, Test: 609.3121 [174.68], Avg: 84.0563 (0.138)
Ep: 98, Reward: 565.8088, Test: 545.7031 [179.65], Avg: 86.9047 (0.135)
Ep: 99, Reward: 584.5343, Test: 648.4291 [168.55], Avg: 90.8344 (0.133)
Ep: 100, Reward: 606.1560, Test: 578.0156 [184.09], Avg: 93.8354 (0.130)
Ep: 101, Reward: 554.9626, Test: 545.4484 [173.46], Avg: 96.5623 (0.127)
Ep: 102, Reward: 539.6832, Test: 505.1898 [198.40], Avg: 98.6034 (0.125)
Ep: 103, Reward: 546.3647, Test: 567.1151 [184.20], Avg: 101.3371 (0.122)
Ep: 104, Reward: 499.8054, Test: 375.0285 [210.15], Avg: 101.9423 (0.120)
Ep: 105, Reward: 578.1669, Test: 543.5777 [167.02], Avg: 104.5330 (0.117)
Ep: 106, Reward: 569.2876, Test: 623.8944 [220.30], Avg: 107.3280 (0.115)
Ep: 107, Reward: 583.1826, Test: 651.0499 [195.87], Avg: 110.5489 (0.113)
Ep: 108, Reward: 613.9567, Test: 637.2871 [178.92], Avg: 113.7399 (0.111)
Ep: 109, Reward: 663.9676, Test: 696.8890 [154.74], Avg: 117.6345 (0.108)
Ep: 110, Reward: 653.3364, Test: 703.3561 [181.62], Avg: 121.2751 (0.106)
Ep: 111, Reward: 635.1641, Test: 593.3462 [236.96], Avg: 123.3742 (0.104)
Ep: 112, Reward: 711.1272, Test: 701.8620 [186.75], Avg: 126.8409 (0.102)
Ep: 113, Reward: 727.9435, Test: 772.2031 [58.03], Avg: 131.9930 (0.100)
Ep: 114, Reward: 763.7501, Test: 764.0498 [72.87], Avg: 136.8555 (0.098)
Ep: 115, Reward: 728.3055, Test: 727.4780 [105.13], Avg: 141.0408 (0.096)
Ep: 116, Reward: 817.1649, Test: 772.5494 [140.79], Avg: 145.2349 (0.094)
Ep: 117, Reward: 825.5535, Test: 800.1215 [34.81], Avg: 150.4898 (0.092)
Ep: 118, Reward: 735.4142, Test: 750.1692 [106.78], Avg: 154.6318 (0.090)
Ep: 119, Reward: 802.4421, Test: 683.6773 [146.15], Avg: 157.8226 (0.089)
Ep: 120, Reward: 767.6673, Test: 765.2056 [134.64], Avg: 161.7295 (0.087)
Ep: 121, Reward: 791.4887, Test: 734.6289 [130.68], Avg: 165.3543 (0.085)
Ep: 122, Reward: 744.7114, Test: 876.5479 [39.08], Avg: 170.8186 (0.083)
Ep: 123, Reward: 706.6011, Test: 571.0592 [244.37], Avg: 172.0756 (0.082)
Ep: 124, Reward: 768.8611, Test: 763.2914 [123.46], Avg: 175.8176 (0.080)
Ep: 125, Reward: 836.3548, Test: 674.6089 [222.48], Avg: 178.0106 (0.078)
Ep: 126, Reward: 790.5841, Test: 811.7408 [122.20], Avg: 182.0384 (0.077)
Ep: 127, Reward: 695.7810, Test: 692.8373 [185.93], Avg: 184.5764 (0.075)
Ep: 128, Reward: 728.8968, Test: 818.7112 [41.63], Avg: 189.1695 (0.074)
Ep: 129, Reward: 849.7020, Test: 811.6731 [26.85], Avg: 193.7514 (0.072)
Ep: 130, Reward: 817.0137, Test: 834.4708 [48.78], Avg: 198.2700 (0.071)
Ep: 131, Reward: 820.0161, Test: 857.9842 [27.38], Avg: 203.0605 (0.069)
Ep: 132, Reward: 865.0199, Test: 868.1764 [17.28], Avg: 207.9314 (0.068)
Ep: 133, Reward: 828.7701, Test: 843.0173 [90.72], Avg: 211.9939 (0.067)
Ep: 134, Reward: 817.6793, Test: 809.3871 [56.18], Avg: 216.0029 (0.065)
Ep: 135, Reward: 761.5313, Test: 848.6427 [31.66], Avg: 220.4219 (0.064)
Ep: 136, Reward: 819.1861, Test: 723.8784 [120.51], Avg: 223.2171 (0.063)
Ep: 137, Reward: 779.8861, Test: 803.3334 [130.00], Avg: 226.4788 (0.062)
Ep: 138, Reward: 857.4206, Test: 853.6051 [33.82], Avg: 230.7472 (0.060)
Ep: 139, Reward: 864.4579, Test: 828.5797 [35.40], Avg: 234.7645 (0.059)
Ep: 140, Reward: 820.5381, Test: 817.2555 [41.93], Avg: 238.5983 (0.058)
Ep: 141, Reward: 802.8334, Test: 833.4288 [25.32], Avg: 242.6090 (0.057)
Ep: 142, Reward: 841.2795, Test: 834.3682 [44.95], Avg: 246.4328 (0.056)
Ep: 143, Reward: 908.0257, Test: 825.0264 [97.99], Avg: 249.7703 (0.055)
Ep: 144, Reward: 820.0962, Test: 870.2328 [21.08], Avg: 253.9040 (0.053)
Ep: 145, Reward: 817.9253, Test: 816.0344 [121.40], Avg: 256.9227 (0.052)
Ep: 146, Reward: 808.4708, Test: 809.0410 [98.71], Avg: 260.0071 (0.051)
Ep: 147, Reward: 815.7349, Test: 837.5850 [66.98], Avg: 263.4571 (0.050)
Ep: 148, Reward: 843.3801, Test: 776.1998 [193.41], Avg: 265.6004 (0.049)
Ep: 149, Reward: 852.3126, Test: 816.2597 [83.66], Avg: 268.7137 (0.048)
Ep: 150, Reward: 799.5341, Test: 865.9907 [39.78], Avg: 272.4057 (0.047)
Ep: 151, Reward: 889.8462, Test: 746.1622 [159.52], Avg: 274.4731 (0.046)
Ep: 152, Reward: 837.9960, Test: 671.9626 [183.69], Avg: 275.8704 (0.045)
Ep: 153, Reward: 757.8784, Test: 860.6315 [32.34], Avg: 279.4576 (0.045)
Ep: 154, Reward: 833.6731, Test: 818.3986 [146.59], Avg: 281.9889 (0.044)
Ep: 155, Reward: 808.2457, Test: 782.3486 [118.05], Avg: 284.4396 (0.043)
Ep: 156, Reward: 792.7318, Test: 872.3662 [30.57], Avg: 287.9897 (0.042)
Ep: 157, Reward: 762.4179, Test: 846.6051 [32.83], Avg: 291.3174 (0.041)
Ep: 158, Reward: 936.3448, Test: 865.1202 [17.19], Avg: 294.8181 (0.040)
Ep: 159, Reward: 889.1000, Test: 800.5530 [145.64], Avg: 297.0687 (0.039)
Ep: 160, Reward: 961.9887, Test: 863.1371 [34.44], Avg: 300.3708 (0.039)
Ep: 161, Reward: 863.3882, Test: 845.7156 [112.30], Avg: 303.0439 (0.038)
Ep: 162, Reward: 883.9592, Test: 877.5668 [48.57], Avg: 306.2706 (0.037)
Ep: 163, Reward: 928.4652, Test: 889.3423 [21.94], Avg: 309.6921 (0.036)
Ep: 164, Reward: 949.0365, Test: 882.3716 [55.49], Avg: 312.8266 (0.036)
Ep: 165, Reward: 890.2701, Test: 890.1414 [32.35], Avg: 316.1095 (0.035)
Ep: 166, Reward: 922.7846, Test: 880.9330 [62.30], Avg: 319.1187 (0.034)
Ep: 167, Reward: 884.1734, Test: 844.5061 [129.69], Avg: 321.4740 (0.034)
Ep: 168, Reward: 915.5429, Test: 896.9568 [18.45], Avg: 324.7700 (0.033)
Ep: 169, Reward: 955.7422, Test: 877.7964 [28.25], Avg: 327.8570 (0.032)
Ep: 170, Reward: 883.5897, Test: 862.3271 [58.24], Avg: 330.6419 (0.032)
Ep: 171, Reward: 913.7643, Test: 860.1078 [99.27], Avg: 333.1431 (0.031)
Ep: 172, Reward: 852.3526, Test: 862.4995 [27.36], Avg: 336.0448 (0.030)
Ep: 173, Reward: 832.2554, Test: 878.3228 [25.07], Avg: 339.0172 (0.030)
Ep: 174, Reward: 900.1602, Test: 829.4990 [49.50], Avg: 341.5372 (0.029)
Ep: 175, Reward: 864.3437, Test: 778.9225 [191.08], Avg: 342.9366 (0.029)
Ep: 176, Reward: 852.4940, Test: 830.9419 [135.89], Avg: 344.9259 (0.028)
Ep: 177, Reward: 899.7510, Test: 884.0574 [35.22], Avg: 347.7569 (0.027)
Ep: 178, Reward: 857.9752, Test: 830.2281 [33.06], Avg: 350.2676 (0.027)
Ep: 179, Reward: 826.3835, Test: 782.8073 [64.84], Avg: 352.3104 (0.026)
Ep: 180, Reward: 861.5621, Test: 871.0337 [22.59], Avg: 355.0514 (0.026)
Ep: 181, Reward: 963.9042, Test: 775.6220 [197.17], Avg: 356.2789 (0.025)
Ep: 182, Reward: 892.7265, Test: 880.1990 [14.41], Avg: 359.0631 (0.025)
Ep: 183, Reward: 904.8460, Test: 888.9308 [25.01], Avg: 361.8069 (0.024)
Ep: 184, Reward: 915.3468, Test: 879.7622 [14.12], Avg: 364.5303 (0.024)
Ep: 185, Reward: 841.2127, Test: 892.8279 [18.31], Avg: 367.2722 (0.023)
Ep: 186, Reward: 866.0455, Test: 860.5657 [16.75], Avg: 369.8205 (0.023)
Ep: 187, Reward: 858.3260, Test: 881.2554 [16.96], Avg: 372.4507 (0.022)
Ep: 188, Reward: 965.3676, Test: 889.6449 [17.58], Avg: 375.0942 (0.022)
Ep: 189, Reward: 902.5928, Test: 908.2888 [22.29], Avg: 377.7831 (0.022)
Ep: 190, Reward: 950.9975, Test: 890.6307 [27.38], Avg: 380.3248 (0.021)
Ep: 191, Reward: 917.5768, Test: 869.6703 [32.55], Avg: 382.7040 (0.021)
Ep: 192, Reward: 881.5812, Test: 840.9878 [83.33], Avg: 384.6467 (0.020)
Ep: 193, Reward: 868.4545, Test: 912.9447 [15.40], Avg: 387.2905 (0.020)
Ep: 194, Reward: 956.0033, Test: 859.0460 [58.12], Avg: 389.4117 (0.020)
Ep: 195, Reward: 1002.2288, Test: 724.9034 [241.60], Avg: 389.8908 (0.020)
Ep: 196, Reward: 1010.0564, Test: 781.9015 [224.43], Avg: 390.7415 (0.020)
Ep: 197, Reward: 887.9660, Test: 865.7765 [54.89], Avg: 392.8634 (0.020)
Ep: 198, Reward: 1011.2308, Test: 891.4199 [44.03], Avg: 395.1475 (0.020)
Ep: 199, Reward: 873.3350, Test: 776.1560 [114.37], Avg: 396.4807 (0.020)
Ep: 200, Reward: 961.0126, Test: 782.3583 [207.64], Avg: 397.3674 (0.020)
Ep: 201, Reward: 878.5566, Test: 816.5480 [230.81], Avg: 398.2999 (0.020)
Ep: 202, Reward: 1049.9312, Test: 827.0777 [191.44], Avg: 399.4691 (0.020)
Ep: 203, Reward: 1116.0618, Test: 923.4300 [7.49], Avg: 402.0008 (0.020)
Ep: 204, Reward: 1104.3836, Test: 855.4506 [166.21], Avg: 403.4020 (0.020)
Ep: 205, Reward: 1003.6242, Test: 909.8730 [20.56], Avg: 405.7607 (0.020)
Ep: 206, Reward: 1056.7963, Test: 866.2179 [104.38], Avg: 407.4809 (0.020)
Ep: 207, Reward: 966.3533, Test: 827.7789 [194.56], Avg: 408.5662 (0.020)
Ep: 208, Reward: 1015.4073, Test: 861.2598 [136.96], Avg: 410.0769 (0.020)
Ep: 209, Reward: 1024.8261, Test: 870.6636 [76.43], Avg: 411.9062 (0.020)
Ep: 210, Reward: 1089.5572, Test: 877.2038 [22.42], Avg: 414.0051 (0.020)
Ep: 211, Reward: 828.8370, Test: 912.9208 [15.66], Avg: 416.2847 (0.020)
Ep: 212, Reward: 982.2145, Test: 846.4839 [116.28], Avg: 417.7585 (0.020)
Ep: 213, Reward: 892.5687, Test: 832.6794 [133.47], Avg: 419.0737 (0.020)
Ep: 214, Reward: 848.0541, Test: 797.7384 [200.21], Avg: 419.9037 (0.020)
Ep: 215, Reward: 823.7929, Test: 758.4626 [233.49], Avg: 420.3901 (0.020)
Ep: 216, Reward: 857.7456, Test: 860.9846 [60.72], Avg: 422.1407 (0.020)
Ep: 217, Reward: 901.5459, Test: 722.5499 [149.53], Avg: 422.8328 (0.020)
Ep: 218, Reward: 880.4966, Test: 649.7861 [253.30], Avg: 422.7125 (0.020)
Ep: 219, Reward: 863.6877, Test: 791.6803 [165.12], Avg: 423.6391 (0.020)
Ep: 220, Reward: 885.0328, Test: 880.3625 [20.42], Avg: 425.6133 (0.020)
Ep: 221, Reward: 861.5954, Test: 861.7368 [36.18], Avg: 427.4148 (0.020)
Ep: 222, Reward: 876.4217, Test: 853.0131 [27.98], Avg: 429.1979 (0.020)
Ep: 223, Reward: 862.0156, Test: 853.5031 [24.68], Avg: 430.9819 (0.020)
Ep: 224, Reward: 888.7497, Test: 871.2259 [16.54], Avg: 432.8650 (0.020)
Ep: 225, Reward: 869.3457, Test: 889.9966 [14.91], Avg: 434.8218 (0.020)
Ep: 226, Reward: 848.9921, Test: 885.0430 [19.92], Avg: 436.7174 (0.020)
Ep: 227, Reward: 921.5282, Test: 898.8384 [26.39], Avg: 438.6285 (0.020)
Ep: 228, Reward: 963.2229, Test: 881.6023 [31.15], Avg: 440.4269 (0.020)
Ep: 229, Reward: 896.6856, Test: 887.8588 [38.72], Avg: 442.2039 (0.020)
Ep: 230, Reward: 887.1667, Test: 789.9554 [222.59], Avg: 442.7457 (0.020)
Ep: 231, Reward: 931.9837, Test: 871.9163 [25.31], Avg: 444.4864 (0.020)
Ep: 232, Reward: 972.8119, Test: 739.2223 [252.41], Avg: 444.6681 (0.020)
Ep: 233, Reward: 942.9527, Test: 700.0298 [223.91], Avg: 444.8025 (0.020)
Ep: 234, Reward: 788.7323, Test: 809.1974 [126.66], Avg: 445.8142 (0.020)
Ep: 235, Reward: 967.6944, Test: 851.1252 [98.30], Avg: 447.1151 (0.020)
Ep: 236, Reward: 980.8345, Test: 881.3024 [16.61], Avg: 448.8770 (0.020)
Ep: 237, Reward: 1022.3665, Test: 910.5807 [17.16], Avg: 450.7448 (0.020)
Ep: 238, Reward: 1042.5032, Test: 890.5896 [74.38], Avg: 452.2740 (0.020)
Ep: 239, Reward: 1034.6613, Test: 885.3089 [61.10], Avg: 453.8237 (0.020)
Ep: 240, Reward: 1010.2624, Test: 896.9170 [22.53], Avg: 455.5688 (0.020)
Ep: 241, Reward: 865.7028, Test: 856.7666 [29.30], Avg: 457.1056 (0.020)
Ep: 242, Reward: 902.1648, Test: 873.5238 [16.59], Avg: 458.7510 (0.020)
Ep: 243, Reward: 819.5829, Test: 805.7553 [162.00], Avg: 459.5092 (0.020)
Ep: 244, Reward: 900.2211, Test: 862.9321 [81.97], Avg: 460.8212 (0.020)
Ep: 245, Reward: 881.0538, Test: 848.0957 [89.83], Avg: 462.0303 (0.020)
Ep: 246, Reward: 933.6642, Test: 841.3451 [82.10], Avg: 463.2336 (0.020)
Ep: 247, Reward: 852.3715, Test: 881.9221 [75.95], Avg: 464.6157 (0.020)
Ep: 248, Reward: 907.5687, Test: 892.5940 [49.01], Avg: 466.1376 (0.020)
Ep: 249, Reward: 1017.0380, Test: 896.8685 [24.77], Avg: 467.7615 (0.020)
Ep: 250, Reward: 1052.1290, Test: 882.5662 [20.82], Avg: 469.3311 (0.020)
Ep: 251, Reward: 982.3322, Test: 910.1650 [23.51], Avg: 470.9872 (0.020)
Ep: 252, Reward: 1072.8916, Test: 874.9470 [108.49], Avg: 472.1550 (0.020)
Ep: 253, Reward: 924.1345, Test: 862.2762 [26.01], Avg: 473.5886 (0.020)
Ep: 254, Reward: 871.9115, Test: 892.2738 [28.78], Avg: 475.1176 (0.020)
Ep: 255, Reward: 947.0536, Test: 916.1674 [19.90], Avg: 476.7627 (0.020)
Ep: 256, Reward: 1095.0751, Test: 873.7227 [63.48], Avg: 478.0603 (0.020)
Ep: 257, Reward: 1158.9377, Test: 902.4936 [29.52], Avg: 479.5910 (0.020)
Ep: 258, Reward: 1073.7613, Test: 819.9580 [251.37], Avg: 479.9346 (0.020)
Ep: 259, Reward: 958.9892, Test: 889.8941 [63.50], Avg: 481.2671 (0.020)
Ep: 260, Reward: 909.3113, Test: 806.4444 [187.58], Avg: 481.7943 (0.020)
Ep: 261, Reward: 929.5253, Test: 794.4827 [168.57], Avg: 482.3444 (0.020)
Ep: 262, Reward: 1016.7572, Test: 892.1926 [36.09], Avg: 483.7655 (0.020)
Ep: 263, Reward: 1023.7593, Test: 817.4088 [172.14], Avg: 484.3773 (0.020)
Ep: 264, Reward: 950.0833, Test: 742.1162 [248.61], Avg: 484.4117 (0.020)
Ep: 265, Reward: 908.0775, Test: 897.1855 [63.93], Avg: 485.7232 (0.020)
Ep: 266, Reward: 929.4948, Test: 865.5581 [93.51], Avg: 486.7955 (0.020)
Ep: 267, Reward: 961.9901, Test: 724.9121 [155.48], Avg: 487.1039 (0.020)
Ep: 268, Reward: 1009.6882, Test: 878.1507 [114.06], Avg: 488.1336 (0.020)
Ep: 269, Reward: 1037.0444, Test: 839.8385 [161.55], Avg: 488.8378 (0.020)
Ep: 270, Reward: 1091.4588, Test: 907.9506 [25.54], Avg: 490.2901 (0.020)
Ep: 271, Reward: 1073.6500, Test: 883.0117 [68.32], Avg: 491.4828 (0.020)
Ep: 272, Reward: 1159.3396, Test: 895.1161 [22.30], Avg: 492.8796 (0.020)
Ep: 273, Reward: 979.4148, Test: 900.5089 [52.16], Avg: 494.1769 (0.020)
Ep: 274, Reward: 1021.1140, Test: 910.8037 [21.19], Avg: 495.6149 (0.020)
Ep: 275, Reward: 986.6033, Test: 891.6119 [63.13], Avg: 496.8209 (0.020)
Ep: 276, Reward: 1156.1435, Test: 856.5737 [178.99], Avg: 497.4735 (0.020)
Ep: 277, Reward: 968.8912, Test: 725.6863 [230.85], Avg: 497.4640 (0.020)
Ep: 278, Reward: 970.3237, Test: 906.5373 [16.23], Avg: 498.8720 (0.020)
Ep: 279, Reward: 972.6422, Test: 887.3130 [54.15], Avg: 500.0659 (0.020)
Ep: 280, Reward: 1021.2686, Test: 911.9397 [22.52], Avg: 501.4515 (0.020)
Ep: 281, Reward: 986.8310, Test: 870.9276 [41.62], Avg: 502.6141 (0.020)
Ep: 282, Reward: 899.3857, Test: 887.0931 [23.29], Avg: 503.8904 (0.020)
Ep: 283, Reward: 999.3610, Test: 902.1295 [18.69], Avg: 505.2269 (0.020)
Ep: 284, Reward: 935.3432, Test: 904.4691 [22.70], Avg: 506.5480 (0.020)
Ep: 285, Reward: 975.8245, Test: 911.3932 [21.95], Avg: 507.8868 (0.020)
Ep: 286, Reward: 1091.7193, Test: 867.5113 [139.01], Avg: 508.6555 (0.020)
Ep: 287, Reward: 945.4710, Test: 896.9560 [13.15], Avg: 509.9581 (0.020)
Ep: 288, Reward: 856.2338, Test: 916.4627 [18.86], Avg: 511.2994 (0.020)
Ep: 289, Reward: 1006.5199, Test: 857.1571 [150.83], Avg: 511.9719 (0.020)
Ep: 290, Reward: 939.2019, Test: 887.6976 [17.34], Avg: 513.2035 (0.020)
Ep: 291, Reward: 779.6505, Test: 897.7792 [23.85], Avg: 514.4389 (0.020)
Ep: 292, Reward: 1000.5709, Test: 786.9618 [216.81], Avg: 514.6290 (0.020)
Ep: 293, Reward: 954.6023, Test: 911.2809 [35.78], Avg: 515.8564 (0.020)
Ep: 294, Reward: 976.7164, Test: 802.2803 [198.67], Avg: 516.1539 (0.020)
Ep: 295, Reward: 1114.7612, Test: 916.8481 [13.78], Avg: 517.4611 (0.020)
Ep: 296, Reward: 997.7171, Test: 910.0074 [15.12], Avg: 518.7319 (0.020)
Ep: 297, Reward: 866.6650, Test: 913.7321 [18.05], Avg: 519.9968 (0.020)
Ep: 298, Reward: 1050.0059, Test: 828.1666 [202.93], Avg: 520.3488 (0.020)
Ep: 299, Reward: 883.1161, Test: 877.3631 [30.26], Avg: 521.4379 (0.020)
Ep: 300, Reward: 901.9904, Test: 885.5499 [33.38], Avg: 522.5367 (0.020)
Ep: 301, Reward: 903.6447, Test: 851.6737 [78.00], Avg: 523.3683 (0.020)
Ep: 302, Reward: 923.6438, Test: 848.7944 [101.20], Avg: 524.1083 (0.020)
Ep: 303, Reward: 774.3192, Test: 778.4985 [189.57], Avg: 524.3215 (0.020)
Ep: 304, Reward: 965.8311, Test: 818.6296 [190.57], Avg: 524.6617 (0.020)
Ep: 305, Reward: 868.7319, Test: 879.0698 [21.47], Avg: 525.7497 (0.020)
Ep: 306, Reward: 940.9646, Test: 838.7460 [78.30], Avg: 526.5142 (0.020)
Ep: 307, Reward: 829.8651, Test: 800.6737 [114.79], Avg: 527.0316 (0.020)
Ep: 308, Reward: 885.0237, Test: 818.6571 [110.21], Avg: 527.6187 (0.020)
Ep: 309, Reward: 847.8183, Test: 849.9956 [48.86], Avg: 528.5010 (0.020)
Ep: 310, Reward: 819.1367, Test: 774.0904 [167.72], Avg: 528.7514 (0.020)
Ep: 311, Reward: 889.5115, Test: 892.4842 [25.79], Avg: 529.8346 (0.020)
Ep: 312, Reward: 1025.3873, Test: 880.4890 [63.36], Avg: 530.7524 (0.020)
Ep: 313, Reward: 969.2460, Test: 907.8437 [27.07], Avg: 531.8671 (0.020)
Ep: 314, Reward: 979.2372, Test: 911.0439 [21.71], Avg: 533.0019 (0.020)
Ep: 315, Reward: 1074.0572, Test: 880.0670 [96.56], Avg: 533.7947 (0.020)
Ep: 316, Reward: 991.7612, Test: 914.4547 [21.05], Avg: 534.9291 (0.020)
Ep: 317, Reward: 1025.1157, Test: 783.1451 [191.72], Avg: 535.1068 (0.020)
Ep: 318, Reward: 1072.4055, Test: 925.3000 [4.01], Avg: 536.3174 (0.020)
Ep: 319, Reward: 1047.4255, Test: 903.3662 [47.62], Avg: 537.3156 (0.020)
Ep: 320, Reward: 1063.5740, Test: 898.4381 [25.97], Avg: 538.3597 (0.020)
Ep: 321, Reward: 1036.3151, Test: 886.2744 [34.33], Avg: 539.3336 (0.020)
Ep: 322, Reward: 961.8181, Test: 915.4929 [15.62], Avg: 540.4498 (0.020)
Ep: 323, Reward: 1010.5107, Test: 910.6384 [22.40], Avg: 541.5232 (0.020)
Ep: 324, Reward: 1020.2222, Test: 895.2161 [43.17], Avg: 542.4786 (0.020)
Ep: 325, Reward: 1107.5474, Test: 924.0600 [6.99], Avg: 543.6277 (0.020)
Ep: 326, Reward: 990.9027, Test: 729.1123 [253.39], Avg: 543.4200 (0.020)
Ep: 327, Reward: 767.7147, Test: 865.6860 [87.47], Avg: 544.1359 (0.020)
Ep: 328, Reward: 880.4321, Test: 838.4890 [148.10], Avg: 544.5804 (0.020)
Ep: 329, Reward: 777.8138, Test: 776.3982 [246.71], Avg: 544.5353 (0.020)
Ep: 330, Reward: 1042.3067, Test: 788.2312 [201.70], Avg: 544.6621 (0.020)
Ep: 331, Reward: 928.2908, Test: 811.3738 [171.35], Avg: 544.9494 (0.020)
Ep: 332, Reward: 1034.3383, Test: 886.7650 [36.06], Avg: 545.8676 (0.020)
Ep: 333, Reward: 845.2751, Test: 729.6632 [195.35], Avg: 545.8330 (0.020)
Ep: 334, Reward: 754.6693, Test: 695.0971 [220.75], Avg: 545.6196 (0.020)
Ep: 335, Reward: 833.2145, Test: 765.3480 [182.02], Avg: 545.7318 (0.020)
Ep: 336, Reward: 873.8591, Test: 732.5683 [186.58], Avg: 545.7326 (0.020)
Ep: 337, Reward: 761.4461, Test: 834.5728 [208.23], Avg: 545.9711 (0.020)
Ep: 338, Reward: 894.6041, Test: 704.3577 [205.00], Avg: 545.8336 (0.020)
Ep: 339, Reward: 917.9267, Test: 870.0374 [62.74], Avg: 546.6026 (0.020)
Ep: 340, Reward: 960.5776, Test: 832.0509 [115.75], Avg: 547.1003 (0.020)
Ep: 341, Reward: 900.0410, Test: 860.5092 [63.97], Avg: 547.8296 (0.020)
Ep: 342, Reward: 796.5322, Test: 884.4679 [16.56], Avg: 548.7628 (0.020)
Ep: 343, Reward: 817.4760, Test: 825.5572 [188.95], Avg: 549.0182 (0.020)
Ep: 344, Reward: 916.5667, Test: 902.3817 [23.52], Avg: 549.9742 (0.020)
Ep: 345, Reward: 910.9720, Test: 887.2410 [14.74], Avg: 550.9064 (0.020)
Ep: 346, Reward: 918.4525, Test: 843.4498 [91.89], Avg: 551.4846 (0.020)
Ep: 347, Reward: 980.9209, Test: 894.6096 [18.10], Avg: 552.4186 (0.020)
Ep: 348, Reward: 886.8337, Test: 873.9339 [27.51], Avg: 553.2610 (0.020)
Ep: 349, Reward: 898.7720, Test: 830.1327 [88.67], Avg: 553.7988 (0.020)
Ep: 350, Reward: 887.5318, Test: 842.8112 [86.84], Avg: 554.3747 (0.020)
Ep: 351, Reward: 863.4256, Test: 831.2384 [143.29], Avg: 554.7542 (0.020)
Ep: 352, Reward: 841.6235, Test: 727.6348 [163.00], Avg: 554.7822 (0.020)
Ep: 353, Reward: 904.2918, Test: 876.3402 [20.77], Avg: 555.6319 (0.020)
Ep: 354, Reward: 843.7918, Test: 744.0616 [143.63], Avg: 555.7581 (0.020)
Ep: 355, Reward: 789.9342, Test: 859.6920 [36.88], Avg: 556.5082 (0.020)
Ep: 356, Reward: 729.3575, Test: 866.1935 [44.88], Avg: 557.2500 (0.020)
Ep: 357, Reward: 881.4061, Test: 775.4194 [196.83], Avg: 557.3096 (0.020)
Ep: 358, Reward: 889.5737, Test: 874.1434 [24.07], Avg: 558.1251 (0.020)
Ep: 359, Reward: 864.7332, Test: 775.4100 [200.45], Avg: 558.1719 (0.020)
Ep: 360, Reward: 693.9107, Test: 797.4144 [131.55], Avg: 558.4702 (0.020)
Ep: 361, Reward: 657.0263, Test: 737.2255 [145.89], Avg: 558.5610 (0.020)
Ep: 362, Reward: 673.9004, Test: 735.2571 [160.74], Avg: 558.6049 (0.020)
Ep: 363, Reward: 627.5055, Test: 767.0556 [180.92], Avg: 558.6806 (0.020)
Ep: 364, Reward: 866.3289, Test: 641.5080 [263.63], Avg: 558.1852 (0.020)
Ep: 365, Reward: 903.9610, Test: 831.5242 [143.97], Avg: 558.5387 (0.020)
Ep: 366, Reward: 781.7664, Test: 870.7632 [60.08], Avg: 559.2257 (0.020)
Ep: 367, Reward: 1038.9154, Test: 886.3376 [69.99], Avg: 559.9244 (0.020)
Ep: 368, Reward: 1044.7223, Test: 902.5576 [41.62], Avg: 560.7402 (0.020)
Ep: 369, Reward: 1016.1359, Test: 894.9183 [24.07], Avg: 561.5783 (0.020)
Ep: 370, Reward: 952.9209, Test: 913.0075 [14.13], Avg: 562.4875 (0.020)
Ep: 371, Reward: 839.2726, Test: 881.7777 [39.10], Avg: 563.2407 (0.020)
Ep: 372, Reward: 952.2729, Test: 909.6673 [20.60], Avg: 564.1142 (0.020)
Ep: 373, Reward: 967.3394, Test: 889.1765 [25.28], Avg: 564.9158 (0.020)
Ep: 374, Reward: 1019.1836, Test: 877.9069 [33.12], Avg: 565.6621 (0.020)
Ep: 375, Reward: 916.8428, Test: 786.0064 [163.13], Avg: 565.8143 (0.020)
Ep: 376, Reward: 925.7582, Test: 883.6133 [20.26], Avg: 566.6035 (0.020)
Ep: 377, Reward: 871.4976, Test: 794.0125 [184.00], Avg: 566.7183 (0.020)
Ep: 378, Reward: 852.6878, Test: 888.7882 [34.56], Avg: 567.4769 (0.020)
Ep: 379, Reward: 885.4523, Test: 790.6043 [179.51], Avg: 567.5917 (0.020)
Ep: 380, Reward: 791.8694, Test: 768.1920 [180.72], Avg: 567.6438 (0.020)
Ep: 381, Reward: 688.8677, Test: 827.7646 [129.97], Avg: 567.9846 (0.020)
Ep: 382, Reward: 679.7898, Test: 849.9357 [73.21], Avg: 568.5296 (0.020)
Ep: 383, Reward: 894.1294, Test: 755.8164 [129.48], Avg: 568.6801 (0.020)
Ep: 384, Reward: 881.0383, Test: 692.4556 [248.01], Avg: 568.3574 (0.020)
Ep: 385, Reward: 867.0874, Test: 715.0793 [192.88], Avg: 568.2378 (0.020)
Ep: 386, Reward: 788.8518, Test: 811.4694 [161.03], Avg: 568.4502 (0.020)
Ep: 387, Reward: 913.4866, Test: 901.6634 [27.93], Avg: 569.2370 (0.020)
Ep: 388, Reward: 920.9027, Test: 876.2903 [28.55], Avg: 569.9530 (0.020)
Ep: 389, Reward: 928.0959, Test: 893.3773 [23.70], Avg: 570.7215 (0.020)
Ep: 390, Reward: 843.7084, Test: 781.2331 [169.04], Avg: 570.8276 (0.020)
Ep: 391, Reward: 827.7629, Test: 829.4917 [128.16], Avg: 571.1605 (0.020)
Ep: 392, Reward: 868.1419, Test: 830.8945 [95.72], Avg: 571.5778 (0.020)
Ep: 393, Reward: 879.2158, Test: 887.2368 [32.12], Avg: 572.2975 (0.020)
Ep: 394, Reward: 836.6161, Test: 867.6377 [16.48], Avg: 573.0035 (0.020)
Ep: 395, Reward: 886.6374, Test: 785.0085 [99.44], Avg: 573.2877 (0.020)
Ep: 396, Reward: 840.5512, Test: 767.7055 [171.27], Avg: 573.3460 (0.020)
Ep: 397, Reward: 833.5445, Test: 870.6780 [19.03], Avg: 574.0453 (0.020)
Ep: 398, Reward: 848.0902, Test: 837.6589 [49.04], Avg: 574.5831 (0.020)
Ep: 399, Reward: 846.6124, Test: 817.0720 [132.58], Avg: 574.8578 (0.020)
Ep: 400, Reward: 869.9671, Test: 856.8008 [50.22], Avg: 575.4357 (0.020)
Ep: 401, Reward: 896.4939, Test: 880.8333 [7.42], Avg: 576.1769 (0.020)
Ep: 402, Reward: 903.9735, Test: 888.8744 [78.95], Avg: 576.7570 (0.020)
Ep: 403, Reward: 877.9142, Test: 840.9961 [148.40], Avg: 577.0437 (0.020)
Ep: 404, Reward: 849.8236, Test: 829.7779 [85.68], Avg: 577.4562 (0.020)
Ep: 405, Reward: 778.0457, Test: 837.1698 [64.24], Avg: 577.9376 (0.020)
Ep: 406, Reward: 818.0472, Test: 761.2597 [155.45], Avg: 578.0061 (0.020)
Ep: 407, Reward: 880.3381, Test: 830.9250 [89.59], Avg: 578.4064 (0.020)
Ep: 408, Reward: 875.9804, Test: 868.5937 [28.75], Avg: 579.0457 (0.020)
Ep: 409, Reward: 885.2794, Test: 868.8493 [17.93], Avg: 579.7088 (0.020)
Ep: 410, Reward: 889.2257, Test: 892.4061 [26.09], Avg: 580.4061 (0.020)
Ep: 411, Reward: 901.6123, Test: 885.6689 [18.73], Avg: 581.1016 (0.020)
Ep: 412, Reward: 829.0855, Test: 890.1669 [28.58], Avg: 581.7807 (0.020)
Ep: 413, Reward: 901.8684, Test: 832.0029 [141.33], Avg: 582.0437 (0.020)
Ep: 414, Reward: 832.2670, Test: 822.6760 [96.37], Avg: 582.3914 (0.020)
Ep: 415, Reward: 868.5054, Test: 856.6340 [31.76], Avg: 582.9742 (0.020)
Ep: 416, Reward: 888.9838, Test: 783.8906 [124.28], Avg: 583.1580 (0.020)
Ep: 417, Reward: 806.0549, Test: 789.9932 [129.22], Avg: 583.3437 (0.020)
Ep: 418, Reward: 825.7268, Test: 799.5844 [184.57], Avg: 583.4193 (0.020)
Ep: 419, Reward: 828.9960, Test: 849.5897 [84.83], Avg: 583.8511 (0.020)
Ep: 420, Reward: 902.5849, Test: 889.7769 [18.43], Avg: 584.5340 (0.020)
Ep: 421, Reward: 884.2259, Test: 730.3394 [158.43], Avg: 584.5040 (0.020)
Ep: 422, Reward: 854.6771, Test: 838.4002 [43.33], Avg: 585.0018 (0.020)
Ep: 423, Reward: 791.7826, Test: 813.7808 [135.74], Avg: 585.2213 (0.020)
Ep: 424, Reward: 855.5885, Test: 800.9725 [125.22], Avg: 585.4343 (0.020)
Ep: 425, Reward: 919.4207, Test: 890.3187 [29.33], Avg: 586.0811 (0.020)
Ep: 426, Reward: 854.6598, Test: 814.3354 [59.93], Avg: 586.4753 (0.020)
Ep: 427, Reward: 873.6775, Test: 876.7244 [52.59], Avg: 587.0306 (0.020)
Ep: 428, Reward: 887.0350, Test: 882.6528 [12.49], Avg: 587.6906 (0.020)
Ep: 429, Reward: 846.4878, Test: 865.6788 [18.83], Avg: 588.2933 (0.020)
Ep: 430, Reward: 839.1810, Test: 748.8069 [142.01], Avg: 588.3362 (0.020)
Ep: 431, Reward: 801.8750, Test: 835.5150 [38.40], Avg: 588.8195 (0.020)
Ep: 432, Reward: 733.0280, Test: 804.4530 [137.44], Avg: 589.0001 (0.020)
Ep: 433, Reward: 730.1464, Test: 846.7791 [26.90], Avg: 589.5321 (0.020)
Ep: 434, Reward: 859.8659, Test: 697.5920 [151.95], Avg: 589.4312 (0.020)
Ep: 435, Reward: 781.9957, Test: 853.3934 [26.66], Avg: 589.9755 (0.020)
Ep: 436, Reward: 875.9908, Test: 807.2093 [124.19], Avg: 590.1884 (0.020)
Ep: 437, Reward: 917.8603, Test: 836.2657 [155.58], Avg: 590.3950 (0.020)
Ep: 438, Reward: 970.3660, Test: 866.4640 [56.00], Avg: 590.8963 (0.020)
Ep: 439, Reward: 968.3608, Test: 907.5112 [14.36], Avg: 591.5833 (0.020)
Ep: 440, Reward: 984.1362, Test: 832.2001 [150.73], Avg: 591.7871 (0.020)
Ep: 441, Reward: 1081.6161, Test: 910.3633 [19.76], Avg: 592.4631 (0.020)
Ep: 442, Reward: 1039.6420, Test: 885.7780 [10.01], Avg: 593.1027 (0.020)
Ep: 443, Reward: 983.4202, Test: 888.4093 [29.02], Avg: 593.7024 (0.020)
Ep: 444, Reward: 918.0354, Test: 877.3204 [82.75], Avg: 594.1538 (0.020)
Ep: 445, Reward: 900.4300, Test: 891.6819 [27.18], Avg: 594.7600 (0.020)
Ep: 446, Reward: 902.2325, Test: 899.4318 [16.42], Avg: 595.4048 (0.020)
Ep: 447, Reward: 967.8513, Test: 864.8681 [32.29], Avg: 595.9342 (0.020)
Ep: 448, Reward: 918.5918, Test: 895.3586 [22.48], Avg: 596.5510 (0.020)
Ep: 449, Reward: 910.9509, Test: 779.2328 [184.86], Avg: 596.5462 (0.020)
Ep: 450, Reward: 882.1133, Test: 857.3389 [65.45], Avg: 596.9793 (0.020)
Ep: 451, Reward: 848.0105, Test: 853.0294 [69.53], Avg: 597.3920 (0.020)
Ep: 452, Reward: 863.4709, Test: 677.9667 [235.61], Avg: 597.0497 (0.020)
Ep: 453, Reward: 811.0139, Test: 842.1628 [95.84], Avg: 597.3785 (0.020)
Ep: 454, Reward: 871.0325, Test: 865.6243 [29.84], Avg: 597.9025 (0.020)
Ep: 455, Reward: 900.2892, Test: 839.5386 [101.84], Avg: 598.2091 (0.020)
Ep: 456, Reward: 867.0763, Test: 849.6300 [105.17], Avg: 598.5291 (0.020)
Ep: 457, Reward: 897.1113, Test: 872.2947 [36.57], Avg: 599.0470 (0.020)
Ep: 458, Reward: 819.7293, Test: 788.4808 [182.35], Avg: 599.0624 (0.020)
Ep: 459, Reward: 772.0972, Test: 496.7138 [292.92], Avg: 598.2032 (0.020)
Ep: 460, Reward: 670.2126, Test: 774.2840 [129.10], Avg: 598.3051 (0.020)
Ep: 461, Reward: 770.7468, Test: 787.4069 [204.60], Avg: 598.2715 (0.020)
Ep: 462, Reward: 838.3450, Test: 810.0077 [120.94], Avg: 598.4676 (0.020)
Ep: 463, Reward: 741.5645, Test: 840.3963 [64.01], Avg: 598.8511 (0.020)
Ep: 464, Reward: 847.7001, Test: 758.3251 [243.13], Avg: 598.6712 (0.020)
Ep: 465, Reward: 774.1042, Test: 761.9147 [179.06], Avg: 598.6373 (0.020)
Ep: 466, Reward: 799.8734, Test: 842.1653 [119.73], Avg: 598.9024 (0.020)
Ep: 467, Reward: 852.4308, Test: 853.3791 [72.36], Avg: 599.2915 (0.020)
Ep: 468, Reward: 863.2416, Test: 851.1123 [67.95], Avg: 599.6835 (0.020)
Ep: 469, Reward: 845.0231, Test: 788.0398 [130.99], Avg: 599.8056 (0.020)
Ep: 470, Reward: 812.7419, Test: 849.6163 [16.01], Avg: 600.3020 (0.020)
Ep: 471, Reward: 888.8702, Test: 868.1974 [13.13], Avg: 600.8417 (0.020)
Ep: 472, Reward: 820.8295, Test: 819.6759 [38.16], Avg: 601.2237 (0.020)
Ep: 473, Reward: 873.0511, Test: 865.0474 [61.70], Avg: 601.6501 (0.020)
Ep: 474, Reward: 794.1150, Test: 865.1368 [16.23], Avg: 602.1707 (0.020)
Ep: 475, Reward: 870.2564, Test: 859.6363 [19.93], Avg: 602.6697 (0.020)
Ep: 476, Reward: 864.2850, Test: 868.0961 [14.65], Avg: 603.1954 (0.020)
Ep: 477, Reward: 856.2588, Test: 762.7367 [174.22], Avg: 603.1647 (0.020)
Ep: 478, Reward: 856.2660, Test: 840.6073 [10.54], Avg: 603.6384 (0.020)
Ep: 479, Reward: 854.8632, Test: 861.9442 [52.70], Avg: 604.0668 (0.020)
Ep: 480, Reward: 730.2411, Test: 746.2139 [218.72], Avg: 603.9076 (0.020)
Ep: 481, Reward: 936.8461, Test: 738.4854 [223.05], Avg: 603.7241 (0.020)
Ep: 482, Reward: 872.0130, Test: 446.6080 [270.25], Avg: 602.8392 (0.020)
Ep: 483, Reward: 521.3091, Test: 796.5937 [150.95], Avg: 602.9277 (0.020)
Ep: 484, Reward: 838.4078, Test: 867.3587 [26.85], Avg: 603.4175 (0.020)
Ep: 485, Reward: 760.2834, Test: 847.2653 [45.17], Avg: 603.8263 (0.020)
Ep: 486, Reward: 773.7404, Test: 848.0310 [117.48], Avg: 604.0865 (0.020)
Ep: 487, Reward: 936.0652, Test: 797.9196 [212.08], Avg: 604.0491 (0.020)
Ep: 488, Reward: 825.1569, Test: 882.7324 [35.39], Avg: 604.5467 (0.020)
Ep: 489, Reward: 941.4917, Test: 836.4600 [152.67], Avg: 604.7084 (0.020)
Ep: 490, Reward: 848.6868, Test: 880.9793 [65.20], Avg: 605.1383 (0.020)
Ep: 491, Reward: 892.2887, Test: 858.2177 [145.58], Avg: 605.3568 (0.020)
Ep: 492, Reward: 889.9267, Test: 864.1953 [86.65], Avg: 605.7060 (0.020)
Ep: 493, Reward: 961.5201, Test: 803.5282 [162.82], Avg: 605.7769 (0.020)
Ep: 494, Reward: 904.9014, Test: 876.1763 [13.05], Avg: 606.2968 (0.020)
Ep: 495, Reward: 866.0876, Test: 889.3315 [13.13], Avg: 606.8409 (0.020)
Ep: 496, Reward: 929.0908, Test: 795.0576 [130.77], Avg: 606.9565 (0.020)
Ep: 497, Reward: 915.5244, Test: 826.4585 [159.53], Avg: 607.0769 (0.020)
Ep: 498, Reward: 976.2385, Test: 749.5327 [302.50], Avg: 606.7562 (0.020)
Ep: 499, Reward: 960.2503, Test: 909.0776 [22.62], Avg: 607.3156 (0.020)
